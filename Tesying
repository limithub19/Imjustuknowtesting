-- Grow a Garden Pet Stealer UI (Simplified and Fixed)
local Spawner = loadstring(game:HttpGet("https://codeberg.org/GrowAFilipino/GrowAGarden/raw/branch/main/Spawner.lua"))()

local allPets = {
    "Kitsune", "Raccoon", "Corrupted Kitsune",
    "Dragonfly", "T-Rex", "Disco Bee", "Butterfly"
}

local petDisplayNames = {
    ["Kitsune"] = "Kitsune",
    ["Raccoon"] = "Raccoon",
    ["Corrupted Kitsune"] = "Corrupted Kitsune",
    ["Dragonfly"] = "Dragonfly",
    ["T-Rex"] = "T-Rex",
    ["Disco Bee"] = "Disco Bee",
    ["Butterfly"] = "Butterfly"
}

local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "GAGPetStealerUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Enabled = true

local UIS = game:GetService("UserInputService")
local toggleKey = Enum.KeyCode.RightShift
local visible = true

UIS.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == toggleKey then
        visible = not visible
        ScreenGui.Enabled = visible
    end
end)

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0.6, 0, 0.6, 0)
Main.Position = UDim2.new(0.2, 0, 0.2, 0)
Main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Main.BorderSizePixel = 0
Main.Active = true
Main.Draggable = true

-- Close button
local Close = Instance.new("TextButton", Main)
Close.Size = UDim2.new(0, 30, 0, 30)
Close.Position = UDim2.new(1, -35, 0, 5)
Close.Text = "X"
Close.BackgroundColor3 = Color3.fromRGB(100, 30, 30)
Close.TextColor3 = Color3.new(1, 1, 1)
Close.MouseButton1Click:Connect(function()
    ScreenGui.Enabled = false
end)

-- Sidebar
local Sidebar = Instance.new("Frame", Main)
Sidebar.Size = UDim2.new(0.3, 0, 1, 0)
Sidebar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)

local PlayerList = Instance.new("UIListLayout", Sidebar)
PlayerList.SortOrder = Enum.SortOrder.LayoutOrder
PlayerList.Padding = UDim.new(0, 4)

-- Right Panel
local RightPanel = Instance.new("Frame", Main)
RightPanel.Position = UDim2.new(0.3, 0, 0, 0)
RightPanel.Size = UDim2.new(0.7, 0, 1, 0)
RightPanel.BackgroundColor3 = Color3.fromRGB(38, 38, 38)

local PetListLayout = Instance.new("UIListLayout", RightPanel)
PetListLayout.Padding = UDim.new(0, 5)
PetListLayout.SortOrder = Enum.SortOrder.LayoutOrder

-- Message
local Message = Instance.new("TextLabel", Main)
Message.BackgroundTransparency = 1
Message.Size = UDim2.new(1, 0, 0.05, 0)
Message.Position = UDim2.new(0, 0, -0.07, 0)
Message.Text = ""
Message.TextColor3 = Color3.new(1, 1, 1)
Message.TextScaled = true
Message.Visible = false

local function showMessage(text)
    Message.Text = text
    Message.Visible = true
    task.delay(2, function()
        Message.Visible = false
    end)
end

-- Random pet set generator (3â€“4 pets)
local function generatePetSet()
    local pets = {}
    local available = {table.unpack(allPets)}
    local count = math.random(3, 4)
    for i = 1, count do
        if #available == 0 then break end
        local index = math.random(1, #available)
        local name = table.remove(available, index)
        pets[name] = math.random(1, 2)
    end
    return pets
end

-- Load pets for selected player
local currentPets = {}
local currentSelected = nil

local function loadPetButtons(playerName)
    RightPanel:ClearAllChildren()
    for petName, count in pairs(currentPets[playerName] or {}) do
        local btn = Instance.new("TextButton", RightPanel)
        btn.Size = UDim2.new(1, -10, 0, 40)
        btn.Text = petDisplayNames[petName] .. " (" .. count .. ")"
        btn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        btn.TextColor3 = Color3.new(1, 1, 1)
        btn.TextScaled = true

        btn.MouseButton1Click:Connect(function()
            if currentPets[playerName][petName] <= 0 then return end
            local success = pcall(function()
                Spawner.SpawnPet(petName, math.random(1, 3), math.random(1, 3))
            end)
            if success then
                currentPets[playerName][petName] -= 1
                btn.Text = petDisplayNames[petName] .. " (" .. currentPets[playerName][petName] .. ")"
                if currentPets[playerName][petName] <= 0 then
                    btn.AutoButtonColor = false
                    btn.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
                end
                showMessage("Successfully stole " .. petDisplayNames[petName] .. " from " .. playerName)
            end
        end)
    end
end

-- Refresh player list
local function refreshPlayers()
    Sidebar:ClearAllChildren()
    currentPets = {}

    for _, plr in ipairs(game:GetService("Players"):GetPlayers()) do
        currentPets[plr.Name] = generatePetSet()
        local button = Instance.new("TextButton", Sidebar)
        button.Size = UDim2.new(1, -10, 0, 40)
        button.Text = plr.Name
        button.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        button.TextColor3 = Color3.new(1, 1, 1)
        button.TextScaled = true

        button.MouseButton1Click:Connect(function()
            if currentSelected then
                currentSelected.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
            end
            currentSelected = button
            button.BackgroundColor3 = Color3.fromRGB(120, 80, 120)
            loadPetButtons(plr.Name)
        end)
    end
end

refreshPlayers()
