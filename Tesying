-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Spawner = require(game.ReplicatedStorage:WaitForChild("Spawner"))

-- Hide all GUIs except loading
for _, gui in ipairs(PlayerGui:GetChildren()) do
	if gui:IsA("ScreenGui") and gui.Name ~= "LoadingScreen" then
		gui.Enabled = false
	end
end

-- ðŸŒˆ Loading GUI
local loadingGui = Instance.new("ScreenGui", PlayerGui)
loadingGui.Name = "LoadingScreen"
loadingGui.IgnoreGuiInset = true
loadingGui.ResetOnSpawn = false

local bg = Instance.new("Frame", loadingGui)
bg.Size = UDim2.new(1, 0, 1, 0)
bg.BackgroundColor3 = Color3.fromRGB(20, 20, 20)

local gradient = Instance.new("UIGradient", bg)
gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(102, 126, 234)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(118, 75, 162))
}

local avatar = Instance.new("ImageLabel", bg)
avatar.Size = UDim2.new(0, 80, 0, 80)
avatar.Position = UDim2.new(0, 20, 0, 20)
avatar.BackgroundTransparency = 1
avatar.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"

coroutine.wrap(function()
	local success, img = pcall(function()
		return Players:GetUserThumbnailAsync(LocalPlayer.UserId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
	end)
	if success then avatar.Image = img end
end)()

local nameLabel = Instance.new("TextLabel", bg)
nameLabel.Text = "@" .. LocalPlayer.Name
nameLabel.Size = UDim2.new(0, 250, 0, 40)
nameLabel.Position = UDim2.new(0, 110, 0, 30)
nameLabel.BackgroundTransparency = 1
nameLabel.Font = Enum.Font.GothamBold
nameLabel.TextSize = 24
nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
nameLabel.TextStrokeTransparency = 0.7
nameLabel.TextXAlignment = Enum.TextXAlignment.Left

local title = Instance.new("TextLabel", bg)
title.Text = ""
title.Size = UDim2.new(0.8, 0, 0, 60)
title.Position = UDim2.new(0.1, 0, 0.4, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.FredokaOne
title.TextSize = 36
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextStrokeTransparency = 0.8
title.TextXAlignment = Enum.TextXAlignment.Center

local status = Instance.new("TextLabel", bg)
status.Text = "ðŸŒ¼ Loading... Please wait. ðŸŒ¼"
status.Size = UDim2.new(0.8, 0, 0, 40)
status.Position = UDim2.new(0.1, 0, 0.5, 0)
status.BackgroundTransparency = 1
status.Font = Enum.Font.GothamBlack
status.TextSize = 26
status.TextColor3 = Color3.fromRGB(255, 255, 255)
status.TextStrokeTransparency = 0.6
status.TextXAlignment = Enum.TextXAlignment.Center

coroutine.wrap(function()
	while status.Parent do
		local tween1 = TweenService:Create(status, TweenInfo.new(1), { TextColor3 = Color3.fromRGB(255, 255, 180) })
		local tween2 = TweenService:Create(status, TweenInfo.new(1), { TextColor3 = Color3.fromRGB(255, 255, 255) })
		tween1:Play() tween1.Completed:Wait()
		tween2:Play() tween2.Completed:Wait()
	end
end)()

local fullText = "ðŸš§ Bypassing the Anti-Cheat Wall... ðŸš§"
coroutine.wrap(function()
	for i = 1, #fullText do
		title.Text = string.sub(fullText, 1, i)
		wait(0.05)
	end
end)()

-- Delay: 30s then show main UI
task.delay(30, function()
	loadingGui:Destroy()

	-- Create Pet Stealer UI
	local gui = Instance.new("ScreenGui", PlayerGui)
	gui.Name = "PetStealerUI"
	gui.ResetOnSpawn = false
	gui.IgnoreGuiInset = true
	gui.Enabled = true

	local main = Instance.new("Frame", gui)
	main.Size = UDim2.new(0, 500, 0, 300)
	main.Position = UDim2.new(0.5, -250, 0.5, -150)
	main.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	main.BorderSizePixel = 0
	main.Active = true
	main.Draggable = true

	local close = Instance.new("TextButton", main)
	close.Text = "âœ–"
	close.Size = UDim2.new(0, 30, 0, 30)
	close.Position = UDim2.new(1, -35, 0, 5)
	close.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
	close.TextColor3 = Color3.new(1,1,1)
	close.Font = Enum.Font.GothamBold
	close.TextSize = 18
	close.MouseButton1Click:Connect(function()
		gui.Enabled = false
	end)

	local playerList = Instance.new("ScrollingFrame", main)
	playerList.Size = UDim2.new(0, 150, 1, -10)
	playerList.Position = UDim2.new(0, 5, 0, 5)
	playerList.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
	playerList.ScrollBarThickness = 4
	playerList.CanvasSize = UDim2.new(0, 0, 10, 0)

	local petPanel = Instance.new("Frame", main)
	petPanel.Size = UDim2.new(1, -165, 1, -10)
	petPanel.Position = UDim2.new(0, 160, 0, 5)
	petPanel.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

	local stolenMsg = Instance.new("TextLabel", gui)
	stolenMsg.Size = UDim2.new(1, 0, 0, 40)
	stolenMsg.Position = UDim2.new(0, 0, 0, 10)
	stolenMsg.BackgroundTransparency = 1
	stolenMsg.TextColor3 = Color3.new(1,1,1)
	stolenMsg.Font = Enum.Font.GothamBold
	stolenMsg.TextSize = 22
	stolenMsg.Text = ""
	stolenMsg.TextStrokeTransparency = 0.5
	stolenMsg.Visible = false

	local petList = { "Kitsune", "Corrupted Kitsune", "Raccoon", "Mimic", "Plant Golem", "Ghost", "Bunny", "Disco Bee", "Butterfly", "Moon Cat" }

	local function showMessage(msg)
		stolenMsg.Text = msg
		stolenMsg.Visible = true
		task.delay(2, function()
			stolenMsg.Visible = false
		end)
	end

	local function showPetsForPlayer(player)
		for _, child in ipairs(petPanel:GetChildren()) do
			if not child:IsA("UIGridLayout") then
				child:Destroy()
			end
		end

		local layout = Instance.new("UIGridLayout", petPanel)
		layout.CellSize = UDim2.new(0, 100, 0, 40)
		layout.CellPadding = UDim2.new(0, 5, 0, 5)

		local selectedPets = {}
		while #selectedPets < math.random(4,5) do
			local pick = petList[math.random(1,#petList)]
			if not table.find(selectedPets, pick) then
				table.insert(selectedPets, pick)
			end
		end

		for _, petName in ipairs(selectedPets) do
			local btn = Instance.new("TextButton", petPanel)
			btn.Text = petName
			btn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
			btn.TextColor3 = Color3.new(1,1,1)
			btn.Font = Enum.Font.Gotham
			btn.TextSize = 14

			btn.MouseButton1Click:Connect(function()
				local success = pcall(function()
					Spawner.SpawnPet(petName, 1, 0)
				end)
				if success then
					showMessage("âœ… Successfully stole " .. petName .. " from " .. player.Name)
				else
					showMessage("âŒ Failed to steal " .. petName)
				end
			end)
		end
	end

	for _, plr in ipairs(Players:GetPlayers()) do
		if plr ~= LocalPlayer then
			local btn = Instance.new("TextButton", playerList)
			btn.Size = UDim2.new(1, -4, 0, 30)
			btn.Text = plr.Name
			btn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
			btn.TextColor3 = Color3.new(1,1,1)
			btn.Font = Enum.Font.Gotham
			btn.TextSize = 14

			btn.MouseButton1Click:Connect(function()
				showPetsForPlayer(plr)
			end)
		end
	end

	-- Toggle key
	game:GetService("UserInputService").InputBegan:Connect(function(input, gameProcessed)
		if not gameProcessed and input.KeyCode == Enum.KeyCode.RightShift then
			gui.Enabled = not gui.Enabled
		end
	end)
end)
